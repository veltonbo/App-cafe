<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Manejo Café</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- FontAwesome para ícones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <!-- SweetAlert2 para modais bonitos -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- jsPDF para exportação PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Seu CSS principal -->
  <link rel="stylesheet" href="style.css">
  <style>
    /* Exemplo de responsividade e FAB */
    .fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: #2196f3;
      color: #fff;
      font-size: 32px;
      border: none;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      cursor: pointer;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .fab.hidden { display: none; }
    .hidden { display: none !important; }
    .resumo-topo { margin-bottom: 16px; }
    .menu-superior { display: flex; gap: 8px; margin-bottom: 16px; }
    .menu-superior button.active { background: #2196f3; color: #fff; }
    .aba { display: none; }
    .aba h2 { margin-top: 0; }
    .filtros { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 12px; }
    .item { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #eee; }
    .item .menu-opcoes { margin-left: 8px; }
    .opcoes-lista { background: #fff; border: 1px solid #ccc; border-radius: 6px; position: absolute; right: 0; top: 32px; min-width: 120px; z-index: 10; }
    .opcoes-lista li { list-style: none; }
    .opcoes-lista button { width: 100%; text-align: left; background: none; border: none; padding: 8px; cursor: pointer; }
    .opcoes-lista button:hover { background: #f0f0f0; }
    /* Adicione mais estilos conforme seu style.css */
  </style>
</head>
<body>
  <!-- Menu Superior -->
  <nav class="menu-superior" role="navigation" aria-label="Menu principal">
    <button data-aba="inicio" aria-label="Início"><i class="fas fa-home"></i> Início</button>
    <button data-aba="aplicacoes" aria-label="Aplicações"><i class="fas fa-flask"></i> Aplicação</button>
    <button data-aba="tarefas" aria-label="Tarefas"><i class="fas fa-tasks"></i> Tarefas</button>
    <button data-aba="financeiro" aria-label="Financeiro"><i class="fas fa-dollar-sign"></i> Financeiro</button>
    <button data-aba="colheita" aria-label="Colheita"><i class="fas fa-tractor"></i> Colheita</button>
    <button data-aba="relatorio" aria-label="Relatórios"><i class="fas fa-chart-bar"></i> Relatórios</button>
    <button data-aba="configuracoes" aria-label="Configurações"><i class="fas fa-cog"></i> Configurações</button>
    <button id="btnAlternarTema" aria-label="Alternar tema"><i class="fas fa-adjust"></i></button>
  </nav>

  <!-- Abas -->
  <main>
    <!-- Início -->
    <section class="aba" id="aba-inicio">
      <h2>Início</h2>
      <div class="resumo-topo">
        <div><strong>Total de Latas:</strong> <span id="totalLatasInicio">0</span></div>
        <div><strong>Total Pago:</strong> <span id="totalPagoInicio">R$ 0,00</span></div>
        <div><strong>Total Pendente:</strong> <span id="totalPendenteInicio">R$ 0,00</span></div>
        <div><strong>Total de Receitas:</strong> <span id="totalReceitasInicio">R$ 0,00</span></div>
        <div><strong>Total de Gastos:</strong> <span id="totalGastosInicio">R$ 0,00</span></div>
        <div><strong>Saldo:</strong> <span id="saldoInicio">R$ 0,00</span></div>
      </div>
      <div>
        <h4>Últimas Aplicações</h4>
        <ul id="ultimasAplicacoesInicio"></ul>
        <h4>Últimas Tarefas</h4>
        <ul id="ultimasTarefasInicio"></ul>
        <h4>Últimas Colheitas</h4>
        <ul id="ultimasColheitasInicio"></ul>
      </div>
    </section>

    <!-- Aplicação -->
    <section class="aba" id="aba-aplicacoes">
      <h2>Aplicações</h2>
      <div id="resumoAplicacoes" class="resumo-topo"></div>
      <div class="filtros">
        <input type="text" id="filtroAplicacoes" placeholder="Pesquisar...">
        <select id="filtroTipoAplicacao"></select>
        <select id="filtroSetorAplicacao"></select>
        <input type="date" id="filtroDataAplicacao">
        <button id="btnLimparFiltroAplicacao" type="button"><i class="fas fa-times"></i> Limpar</button>
      </div>
      <div id="listaAplicacoes"></div>
      <button id="fab-aplicacao" class="fab" aria-label="Adicionar aplicação">+</button>
      <form id="formAplicacao" class="hidden">
        <input type="hidden" id="aplicacaoIdEdit">
        <input type="date" id="dataApp" required>
        <input type="text" id="produtoApp" list="sugestoesProdutoApp" placeholder="Produto" required>
        <datalist id="sugestoesProdutoApp"></datalist>
        <input type="text" id="dosagemApp" placeholder="Dosagem" required>
        <select id="tipoApp">
          <option value="Adubo">Adubo</option>
          <option value="Defensivo">Defensivo</option>
        </select>
        <input type="text" id="setorApp" list="sugestoesSetor" placeholder="Setor">
        <datalist id="sugestoesSetor"></datalist>
        <button type="submit" id="btnSalvarAplicacao">Salvar Aplicação</button>
        <button type="button" id="btnCancelarEdicaoApp" class="hidden">Cancelar</button>
      </form>
    </section>

    <!-- Tarefas -->
    <section class="aba" id="aba-tarefas">
      <h2>Tarefas</h2>
      <div id="resumoTarefas" class="resumo-topo"></div>
      <div class="filtros">
        <input type="text" id="filtroTarefasDescricao" placeholder="Pesquisar...">
        <input type="date" id="filtroTarefasData">
        <select id="filtroTarefasSetor"></select>
        <select id="filtroTarefasPrioridade">
          <option value="">Prioridade</option>
          <option value="Alta">Alta</option>
          <option value="Média">Média</option>
          <option value="Baixa">Baixa</option>
        </select>
        <select id="filtroTarefasProduto"></select>
        <button id="btnLimparFiltroTarefas" type="button"><i class="fas fa-times"></i> Limpar</button>
      </div>
      <h3>Pendentes</h3>
      <div id="listaTarefasPendentes"></div>
      <h3>Concluídas</h3>
      <div id="listaTarefasConcluidas"></div>
      <button id="fab-tarefa" class="fab" aria-label="Adicionar tarefa">+</button>
      <form id="formTarefa" class="hidden">
        <input type="hidden" id="tarefaIdEdit">
        <input type="date" id="dataTarefa" required>
        <input type="text" id="descricaoTarefa" placeholder="Descrição" required>
        <select id="prioridadeTarefa">
          <option value="Alta">Alta</option>
          <option value="Média">Média</option>
          <option value="Baixa">Baixa</option>
        </select>
        <input type="text" id="setorTarefa" list="sugestoesSetor" placeholder="Setor">
        <datalist id="sugestoesSetor"></datalist>
        <label><input type="checkbox" id="eAplicacaoTarefaCheckbox"> É aplicação?</label>
        <div id="camposAplicacaoTarefa" class="hidden">
          <input type="text" id="produtoAplicacaoTarefa" list="sugestoesProdutoApp" placeholder="Produto">
          <input type="text" id="dosagemAplicacaoTarefa" placeholder="Dosagem">
          <select id="tipoAplicacaoTarefa">
            <option value="Adubo">Adubo</option>
            <option value="Defensivo">Defensivo</option>
          </select>
        </div>
        <button type="submit" id="btnSalvarTarefa">Salvar Tarefa</button>
        <button type="button" id="btnCancelarEdicaoTarefa" class="hidden">Cancelar</button>
      </form>
    </section>

    <!-- Financeiro -->
    <section class="aba" id="aba-financeiro">
      <h2>Financeiro</h2>
      <div id="resumoFinanceiro" class="resumo-topo"></div>
      <div class="filtros">
        <input type="text" id="filtroFinanceiroDescricao" placeholder="Pesquisar...">
        <input type="date" id="filtroFinanceiroData">
        <select id="filtroFinanceiroCategoria"></select>
        <select id="filtroFinanceiroTipo"></select>
        <button id="btnLimparFiltroFinanceiro" type="button"><i class="fas fa-times"></i> Limpar</button>
      </div>
      <div id="listaFinanceiro"></div>
      <button id="fab-financeiro" class="fab" aria-label="Adicionar lançamento">+</button>
      <form id="formFinanceiro" class="hidden">
        <input type="hidden" id="financeiroIdEdit">
        <select id="tipoLancamentoFin">
          <option value="receita">Receita</option>
          <option value="gasto">Gasto</option>
        </select>
        <input type="date" id="dataFin" required>
        <input type="text" id="descricaoFin" placeholder="Descrição" required>
        <input type="number" id="valorFin" placeholder="Valor" required min="0" step="0.01">
        <input type="text" id="categoriaFin" list="sugestoesCategoriaFin" placeholder="Categoria">
        <datalist id="sugestoesCategoriaFin"></datalist>
        <label><input type="checkbox" id="parceladoFin"> Parcelado?</label>
        <div id="camposParcelasFin" class="hidden">
          <input type="number" id="numParcelasFin" min="2" value="2" placeholder="Nº de parcelas">
        </div>
        <button type="submit" id="btnSalvarFinanceiro">Salvar Lançamento</button>
        <button type="button" id="btnCancelarEdicaoFin" class="hidden">Cancelar</button>
      </form>
    </section>

    <!-- Colheita -->
    <section class="aba" id="aba-colheita">
      <h2>Colheita</h2>
      <div id="resumoColheita" class="resumo-topo"></div>
      <div class="filtros">
        <select id="filtroColheitaColhedor"></select>
        <input type="date" id="filtroColheitaData">
        <button id="btnLimparFiltroColheita" type="button"><i class="fas fa-times"></i> Limpar</button>
      </div>
      <h3>Pendentes</h3>
      <div id="colheitaPendentes"></div>
      <h3>Pagos</h3>
      <div id="colheitaPagos"></div>
      <button id="fab-colheita" class="fab" aria-label="Adicionar colheita">+</button>
      <form id="formColheita" class="hidden">
        <input type="date" id="dataColheita" required>
        <input type="text" id="colhedor" list="sugestoesColhedor" placeholder="Colhedor" required>
        <datalist id="sugestoesColhedor"></datalist>
        <input type="number" id="quantidadeLatas" placeholder="Quantidade de latas" required min="0" step="0.01">
        <label>Valor da lata: <input type="number" id="valorLata" min="0" step="0.01"></label>
        <button type="submit" id="btnSalvarColheita">Salvar Lançamento</button>
        <button type="button" id="btnCancelarEdicaoColheita" class="hidden">Cancelar</button>
      </form>
    </section>

    <!-- Relatórios -->
    <section class="aba" id="aba-relatorio">
      <h2>Relatórios</h2>
      <button onclick="exportarPDF()"><i class="fas fa-file-pdf"></i> Exportar PDF</button>
      <button onclick="exportarRelatorioCSV()"><i class="fas fa-file-csv"></i> Exportar CSV</button>
      <h3>Aplicações</h3>
      <div id="resumoRelAplicacoes"></div>
      <h3>Tarefas</h3>
      <div id="resumoRelTarefas"></div>
      <h3>Financeiro</h3>
      <div id="resumoRelFinanceiro"></div>
      <h3>Colheita</h3>
      <div id="resumoRelColheita"></div>
    </section>

    <!-- Configurações -->
    <section class="aba" id="aba-configuracoes">
      <h2>Configurações</h2>
      <div class="resumo-topo">
        <div><strong>Ano da safra atual:</strong> <span id="anoSafraAtual"></span></div>
      </div>
      <div>
        <label for="safraSelecionada">Safra arquivada:</label>
        <select id="safraSelecionada"></select>
        <button id="btnFecharSafra"><i class="fas fa-archive"></i> Fechar safra</button>
        <button id="btnRestaurarSafra"><i class="fas fa-undo"></i> Restaurar safra</button>
        <button id="btnDeletarSafra"><i class="fas fa-trash"></i> Deletar safra</button>
      </div>
      <div>
        <button id="btnBackup"><i class="fas fa-download"></i> Backup</button>
        <input type="file" id="arquivoBackup" accept=".json">
        <button id="btnImportarBackup"><i class="fas fa-upload"></i> Importar Backup</button>
      </div>
      <div>
        <button id="btnAlternarTema"><i class="fas fa-adjust"></i> Alternar tema</button>
      </div>
    </section>
  </main>

  <!-- Modais, Toasts e Loader são criados dinamicamente pelo JS -->

  <!-- Firebase e scripts principais -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="js/firebase-config.js"></script>
  <script src="js/main.js"></script>
  <script src="js/inicio.js"></script>
  <script src="js/aplicacao.js"></script>
  <script src="js/tarefas.js"></script>
  <script src="js/financeiro.js"></script>
  <script src="js/colheita.js"></script>
  <script src="js/relatorio.js"></script>
  <script src="js/configuracoes.js"></script>
</body>
</html>
